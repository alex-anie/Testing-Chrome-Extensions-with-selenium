/* Copyright 2011 Google Inc. All Rights Reserved. */ (function(){var p=typeof Object.defineProperties=="function"?Object.defineProperty:function(a,b,d){if(a==Array.prototype||a==Object.prototype)return a;a[b]=d.value;return a},aa=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var b=0;b<a.length;++b){var d=a[b];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");},r=aa(this),t=function(a,b){if(b)a:{var d=r;a=a.split(".");for(var g=0;g<a.length-
1;g++){var e=a[g];if(!(e in d))break a;d=d[e]}a=a[a.length-1];g=d[a];b=b(g);b!=g&&b!=null&&p(d,a,{configurable:!0,writable:!0,value:b})}},u=function(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}},v=function(a){var b=typeof Symbol!="undefined"&&Symbol.iterator&&a[Symbol.iterator];if(b)return b.call(a);if(typeof a.length=="number")return{next:u(a)};throw Error(String(a)+" is not an iterable or ArrayLike");},w=function(){this.s=!1;this.j=null;this.F=void 0;this.h=1;
this.I=this.O=0;this.o=null},x=function(a){if(a.s)throw new TypeError("Generator is already running");a.s=!0};w.prototype.u=function(a){this.F=a};w.prototype.A=function(a){this.o={P:a,T:!0};this.h=this.O||this.I};w.prototype.return=function(a){this.o={return:a};this.h=this.I};var y=function(a,b,d){a.h=d;return{value:b}},z=function(a){this.g=new w;this.V=a};z.prototype.u=function(a){x(this.g);if(this.g.j)return A(this,this.g.j.next,a,this.g.u);this.g.u(a);return B(this)};
var ba=function(a,b){x(a.g);var d=a.g.j;if(d)return A(a,"return"in d?d["return"]:function(g){return{value:g,done:!0}},b,a.g.return);a.g.return(b);return B(a)};z.prototype.A=function(a){x(this.g);if(this.g.j)return A(this,this.g.j["throw"],a,this.g.u);this.g.A(a);return B(this)};
var A=function(a,b,d,g){try{var e=b.call(a.g.j,d);if(!(e instanceof Object))throw new TypeError("Iterator result "+e+" is not an object");if(!e.done)return a.g.s=!1,e;var l=e.value}catch(c){return a.g.j=null,a.g.A(c),B(a)}a.g.j=null;g.call(a.g,l);return B(a)},B=function(a){for(;a.g.h;)try{var b=a.V(a.g);if(b)return a.g.s=!1,{value:b.value,done:!1}}catch(d){a.g.F=void 0,a.g.A(d)}a.g.s=!1;if(a.g.o){b=a.g.o;a.g.o=null;if(b.T)throw b.P;return{value:b.return,done:!0}}return{value:void 0,done:!0}},C=function(a){this.next=
function(b){return a.u(b)};this.throw=function(b){return a.A(b)};this.return=function(b){return ba(a,b)};this[Symbol.iterator]=function(){return this}},D=function(a){function b(g){return a.next(g)}function d(g){return a.throw(g)}return new Promise(function(g,e){function l(c){c.done?g(c.value):Promise.resolve(c.value).then(b,d).then(l,e)}l(a.next())})};
t("Symbol",function(a){if(a)return a;var b=function(l,c){this.M=l;p(this,"description",{configurable:!0,writable:!0,value:c})};b.prototype.toString=function(){return this.M};var d="jscomp_symbol_"+(Math.random()*1E9>>>0)+"_",g=0,e=function(l){if(this instanceof e)throw new TypeError("Symbol is not a constructor");return new b(d+(l||"")+"_"+g++,l)};return e});
t("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var b="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),d=0;d<b.length;d++){var g=r[b[d]];typeof g==="function"&&typeof g.prototype[a]!="function"&&p(g.prototype,a,{configurable:!0,writable:!0,value:function(){return ca(u(this))}})}return a});var ca=function(a){a={next:a};a[Symbol.iterator]=function(){return this};return a};
t("Promise",function(a){function b(){this.i=null}function d(c){return c instanceof e?c:new e(function(f){f(c)})}if(a)return a;b.prototype.G=function(c){if(this.i==null){this.i=[];var f=this;this.H(function(){f.R()})}this.i.push(c)};var g=r.setTimeout;b.prototype.H=function(c){g(c,0)};b.prototype.R=function(){for(;this.i&&this.i.length;){var c=this.i;this.i=[];for(var f=0;f<c.length;++f){var h=c[f];c[f]=null;try{h()}catch(k){this.N(k)}}}this.i=null};b.prototype.N=function(c){this.H(function(){throw c;
})};var e=function(c){this.m=0;this.v=void 0;this.l=[];this.K=!1;var f=this.C();try{c(f.resolve,f.reject)}catch(h){f.reject(h)}};e.prototype.C=function(){function c(k){return function(m){h||(h=!0,k.call(f,m))}}var f=this,h=!1;return{resolve:c(this.X),reject:c(this.D)}};e.prototype.X=function(c){if(c===this)this.D(new TypeError("A Promise cannot resolve to itself"));else if(c instanceof e)this.Z(c);else{a:switch(typeof c){case "object":var f=c!=null;break a;case "function":f=!0;break a;default:f=!1}f?
this.W(c):this.J(c)}};e.prototype.W=function(c){var f=void 0;try{f=c.then}catch(h){this.D(h);return}typeof f=="function"?this.aa(f,c):this.J(c)};e.prototype.D=function(c){this.L(2,c)};e.prototype.J=function(c){this.L(1,c)};e.prototype.L=function(c,f){if(this.m!=0)throw Error("Cannot settle("+c+", "+f+"): Promise already settled in state"+this.m);this.m=c;this.v=f;this.m===2&&this.Y();this.S()};e.prototype.Y=function(){var c=this;g(function(){if(c.U()){var f=r.console;typeof f!=="undefined"&&f.error(c.v)}},
1)};e.prototype.U=function(){if(this.K)return!1;var c=r.CustomEvent,f=r.Event,h=r.dispatchEvent;if(typeof h==="undefined")return!0;typeof c==="function"?c=new c("unhandledrejection",{cancelable:!0}):typeof f==="function"?c=new f("unhandledrejection",{cancelable:!0}):(c=r.document.createEvent("CustomEvent"),c.initCustomEvent("unhandledrejection",!1,!0,c));c.promise=this;c.reason=this.v;return h(c)};e.prototype.S=function(){if(this.l!=null){for(var c=0;c<this.l.length;++c)l.G(this.l[c]);this.l=null}};
var l=new b;e.prototype.Z=function(c){var f=this.C();c.B(f.resolve,f.reject)};e.prototype.aa=function(c,f){var h=this.C();try{c.call(f,h.resolve,h.reject)}catch(k){h.reject(k)}};e.prototype.then=function(c,f){function h(n,q){return typeof n=="function"?function(K){try{k(n(K))}catch(L){m(L)}}:q}var k,m,M=new e(function(n,q){k=n;m=q});this.B(h(c,k),h(f,m));return M};e.prototype.catch=function(c){return this.then(void 0,c)};e.prototype.B=function(c,f){function h(){switch(k.m){case 1:c(k.v);break;case 2:f(k.v);
break;default:throw Error("Unexpected state: "+k.m);}}var k=this;this.l==null?l.G(h):this.l.push(h);this.K=!0};e.resolve=d;e.reject=function(c){return new e(function(f,h){h(c)})};e.race=function(c){return new e(function(f,h){for(var k=v(c),m=k.next();!m.done;m=k.next())d(m.value).B(f,h)})};e.all=function(c){var f=v(c),h=f.next();return h.done?d([]):new e(function(k,m){function M(K){return function(L){n[K]=L;q--;q==0&&k(n)}}var n=[],q=0;do n.push(void 0),q++,d(h.value).B(M(n.length-1),m),h=f.next();
while(!h.done)})};return e});var da=function(a,b){a instanceof String&&(a+="");var d=0,g=!1,e={next:function(){if(!g&&d<a.length){var l=d++;return{value:b(l,a[l]),done:!1}}g=!0;return{done:!0,value:void 0}}};e[Symbol.iterator]=function(){return e};return e};t("Array.prototype.keys",function(a){return a?a:function(){return da(this,function(b){return b})}});var E,F,G,H,I,J,N,O,P,Q,R,S,T,ea,U,V,W,fa=function(){var a,b;return D(new C(new z(function(d){if(d.h==1)return a={},a.language=G.options[G.selectedIndex].value,a.popupDblclick=H.checked?"true":"false",a.popupSelect=N.checked?"true":"false",a.popupDblclickKey=J.options[J.selectedIndex].value,a.popupSelectKey=P.options[P.selectedIndex].value,a.storeHistory=Q.checked?"true":"false",a.allowCrossExtensionHistory=T.checked?"true":"false",a.enableHttps="true",y(d,chrome.storage.local.set({options:a}),2);
b=document.getElementById("save-status");b.style.setProperty("-webkit-transition","opacity 0s ease-out");b.style.opacity=1;window.setTimeout(function(){b.style.setProperty("-webkit-transition","opacity 0.4s ease-out");b.style.opacity=0},1500);X(!1);d.h=0})))},ha=function(){return new Promise(function(a){chrome.storage.local.get("options",function(b){a(b.options)})})},la=function(){var a,b,d;return D(new C(new z(function(g){switch(g.h){case 1:if(!(new URLSearchParams(window.location.search)).has("migrate")){g.h=
2;break}a="options"in window.localStorage?JSON.parse(window.localStorage.options):void 0;b={};return y(g,chrome.storage.local.set((b["storage-migrated"]=!0,b.options=a,b)),3);case 3:window.close();case 2:return X(!1),y(g,ha(),4);case 4:d=g.F,Y(G,d.language),H.checked=d.popupDblclick==="true",ia(),N.checked=d.popupSelect==="true",ja(),Y(J,d.popupDblclickKey),Y(P,d.popupSelectKey),Q.checked=d.storeHistory==="true",T.checked=d.allowCrossExtensionHistory==="true",ka(),chrome.storage.local.get("word-history",
function(e){R=e=Object.keys(e["word-history"]).length;S.textContent=e;Z()}),g.h=0}})))},Z=function(){R>0&&Q.checked?(U.disabled=!1,W.disabled=!1):R===0&&(U.disabled=!0,W.disabled=!0)},ma=function(a){var b="";a=a["word-history"];for(var d in a){var g=d.split("<"),e=a[d];b+=g[0];b+="\t";b+=g[1];b+="\t";b+=g[2];b+="\t";b+=e;b+="\n"}V.href=window.URL.createObjectURL(new Blob([b],{type:"text/plain"}));b=V;d=document.createEvent("MouseEvents");d.initEvent("click",!0,!0);b.dispatchEvent(d)},na=function(){chrome.storage.local.get("word-history",
ma)},oa=function(){chrome.storage.local.set({"word-history":{}});R=0;S.textContent=0;Z()},Y=function(a,b){for(var d=a.options.length,g=0;g<d;g++)if(a.options[g].value===b){a.options[g].selected=!0;break}},X=function(a){E.disabled=!a;F.disabled=!a},pa=function(){X(!0)},ia=function(){var a=H.checked;J.disabled=!a;I.className=a?"":"text-disabled"},ja=function(){var a=N.checked;P.disabled=!a;O.className=a?"":"text-disabled"},ka=function(){var a=Q.checked;T.disabled=!a;ea.className=a?"":"text-disabled";
a||(T.checked=!1);U.disabled=!a;W.disabled=!a;Z()};
(function(){E=document.getElementById("save-btn");F=document.getElementById("reset-btn");G=document.getElementById("language-selector");H=document.getElementById("popup-dblclick-checkbox");I=document.getElementById("popup-dblclick-text");J=document.getElementById("popup-dblclick-key");N=document.getElementById("popup-select-checkbox");O=document.getElementById("popup-select-text");P=document.getElementById("popup-select-key");Q=document.getElementById("store-history-checkbox");S=document.getElementById("num-words-in-history");
T=document.getElementById("allow-cross-extension-history-checkbox");ea=document.getElementById("allow-cross-extension-history-text");U=document.getElementById("download-history-btn");V=document.getElementById("download-history-link");W=document.getElementById("clear-history-btn");R=0;E.addEventListener("click",fa,!1);F.addEventListener("click",la,!1);H.addEventListener("change",function(){ia()},!1);N.addEventListener("change",function(){ja()},!1);Q.addEventListener("change",function(){ka()},!1);U.addEventListener("click",
na,!1);W.addEventListener("click",oa,!1);document.getElementById("year").innerText=(new Date).getFullYear();for(var a=document.getElementsByTagName("input"),b,d=0;b=a[d];d++)b.addEventListener("change",pa,!1);a=document.getElementsByTagName("select");for(d=0;b=a[d];d++)b.addEventListener("change",pa,!1);window.navigator.platform.toLowerCase().indexOf("mac")!==-1&&(document.getElementById("popup-dblclick-key-ctrl").textContent="Command",document.getElementById("popup-select-key-ctrl").textContent=
"Command");la()})();})();
